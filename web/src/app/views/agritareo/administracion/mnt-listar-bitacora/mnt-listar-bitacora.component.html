<div class="header-content">
  <h1>
    Lista de bitacoras
  </h1>
</div>
<div class="container-fluid mt-2">
  <div class="row mt-2">
    <div class="col">
      <p-table
      #dt1
      [value]="data"
      dataKey="idbitacora_agricola_sanitaria"
      [paginator]="true"
      [rows]="15"
      [showCurrentPageReport]="true"
      [rowsPerPageOptions]="[15,25,50,100]"
      selectionMode="single"
      [globalFilterFields]="['cultivo','variedad','glosa','evaluador','concepto_agricola','parcela','fecha','area_sembrada']">
      <ng-template pTemplate="caption">
        <div class="p-d-flex p-ai-center p-jc-between">
            <span class="p-input-icon-left">
                <i class="pi pi-search"></i>
                <input pInputText type="text" (input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Search..." />
            </span>
        </div>
    </ng-template>
      <ng-template pTemplate="header">
          <tr>
              <th pSortableColumn="tipo_registro">Tipo Registro <p-sortIcon field="tipo_registro"></p-sortIcon></th>
              <th pSortableColumn="fecha">Fecha <p-sortIcon field="fecha"></p-sortIcon></th>
              <th pSortableColumn="evaluador">Evaluador <p-sortIcon field="evaluador"></p-sortIcon></th>
              <th pSortableColumn="parcela">Parcela <p-sortIcon field="parcela"></p-sortIcon></th>
              <th pSortableColumn="cultivo">Cultivo <p-sortIcon field="cultivo"></p-sortIcon></th>
              <th pSortableColumn="variedad">Variedad <p-sortIcon field="variedad"></p-sortIcon></th>
              <th pSortableColumn="area_sembrada">Area sembrada <p-sortIcon field="area_sembrada"></p-sortIcon></th>
              <th pSortableColumn="concepto_agricola">Concepto Agricola <p-sortIcon field="concepto_agricola"></p-sortIcon></th>
              <th pSortableColumn="glosa">Glosa<p-sortIcon field="glosa"></p-sortIcon></th>
              <th>Image</th>
              <th style="width:4rem"></th>
          </tr>
      </ng-template>
      <ng-template pTemplate="body" let-bitacora let-expanded="expanded">
          <tr>
              <td>{{bitacora.tipo_registro}}</td>
              <td>{{formatDate(bitacora.fecha)}}</td>
              <td>{{bitacora.evaluador}}</td>
              <td>{{bitacora.parcela}}</td>
              <td>{{bitacora.cultivo}}</td>
              <td>{{bitacora.variedad}}</td>
              <td>{{bitacora.area_sembrada}}</td>
              <td>{{bitacora.concepto_agricola}}</td>
              <td>{{bitacora.glosa}}</td>
              <td><img [src]="bitacora.ruta" width="100" class="p-shadow-4" [preview]="true" /></td>
              <td>
                <button class="btn btn-primary" (click)="editMode(bitacora)"><i class="fas fa-eye"></i></button>
                <!-- <button type="button" pButton pRipple (click)="editMode(bitacora)"></button> -->
            </td>
          </tr>
      </ng-template>
    </p-table>
    </div>
  </div>
</div>

<p-dialog
[(visible)]="productDialog"
[style]="{width: '950px'}"
header="Detalle de Bitacora"
[modal]="true"
styleClass="p-fluid"
>
  <ng-template pTemplate="content" >
    <div class="col-md-12">
      <div class="row section">
        <div class="col-md-3">
          <div class="p-field">
            <label>Tipo de Registro</label>
            <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.tipo_registro" required autofocus />
          </div>
        </div>
        <div class="col-md-3">
          <div class="p-field">
            <label>Evaluador</label>
            <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.evaluador" required autofocus />
          </div>
        </div>
        <div class="col-md-3">
          <div class="p-field">
            <label>Fecha</label>
            <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.fecha" required autofocus />
          </div>
        </div>
        <div class="col-md-3">
          <div class="p-field">
            <label>Parcela</label>
            <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.parcela" required autofocus />
          </div>
        </div>
      </div>

      <h3 class="mt-3">Referencia de parcela</h3>
      <div class="row section">
        <div class="col-md-12">
          <div class="row">
            <div class="col-md-2">
              <div class="p-field">
                <label>Cultivo</label>
                <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.cultivo" required autofocus />
              </div>
            </div>
            <div class="col-md-2">
              <label>Variedad</label>
              <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.variedad" required autofocus />
            </div>
            <div class="col-md-2">
              <label>Campaña</label>
              <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.codigo_campania" required autofocus />
            </div>
            <div class="col-md-4">
              <label>Descripcion de campaña</label>
              <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.descripcion_campania" required autofocus />
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-2">
              <label>Día de crecimiento</label>
              <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.dia_crecimiento" required autofocus />
            </div>
            <div class="col-md-2">
              <label>Semana de crecimiento</label>
              <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.semana_crecimiento" required autofocus />
            </div>
            <div class="col-md-2">
              <label>Estado fenologico</label>
              <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.fenologia_variedad" required autofocus />
            </div>
            <div class="col-md-2">
              <label>Area sembrada</label>
              <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.area_sembrada" required autofocus />
            </div>
          </div>
        </div>
    </div>

    <h3 class="mt-3">Evaluaciones sanitarias</h3>
      <div class="row section">
        <div class="col-md-12">
          <div class="row">
            <div class="col-md-3">
              <div class="p-field">
                <label>Concepto agricola</label>
                <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.concepto_agricola" required autofocus />
              </div>
            </div>
            <div class="col-md-3">
              <label>Organo afectado</label>
              <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.organo_afectado" required autofocus />
            </div>
            <div class="col-md-3">
              <label>Método de evaluacion</label>
              <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.metodo_evaluacion" required autofocus />
            </div>
            <div class="col-md-3">
              <label>Unidad de medida</label>
              <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.unidad_medida" required autofocus />
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-md-3">
              <label>Glosa</label>
              <textarea type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.glosa" required autofocus></textarea>
            </div>
            <div class="col-md-3">
              <label>Valor encontrado</label>
              <input type="text" [disabled]="true" pInputText id="name" [(ngModel)]="bitacora.valor_encontrado" required autofocus />
            </div>
            <div class="col-md-3">
              <label>Imagen</label>
              <div class="ful-img" id="fullImgBox">
                <img [src]="bitacora.ruta" [alt]="" id="fullImg" />
                <span (click)="closeImg()">X</span>
              </div>
              <img (click)="openFullImg()" [src]="bitacora.ruta" [alt]="" width="430" class="p-shadow-4 image" />
            </div>
          </div>
        </div>
    </div>
          </div>
        </ng-template>
</p-dialog>

<!-- <div *ngIf="binnacle$ | async as binnacles">
  <p *ngFor="let binnacle of binnacles">
    {{binnacle.evaluador}}
  </p>
</div> -->

<!-- {{(binnacle$ | async) | json}} -->


